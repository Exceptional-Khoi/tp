@startuml
' Rectangles + minimal chrome
skinparam sequenceParticipantType rectangle
skinparam shadowing false
skinparam responseMessageBelowArrow true
hide footbox

actor    User
participant ":UI" as UI
participant ":FitChasers" as App
participant ":WorkoutManager" as WM
participant ":Tagger" as Tagger
participant ":FileHandler" as FH
participant ":Workout" as W

User -> UI : enterText()
UI -> App : readCommand()
App -> WM : addWorkout(command)

alt activeWorkoutExists
  WM -> UI : showMessage("Active workout exists. Please end it.")
else noActiveWorkout
  alt strictFormatDetected
    WM -> WM : formatInputForWorkoutStrict(command)
    alt inputInvalid
      WM -> UI : showMessage(error)
    else inputValid
      WM -> UI : confirmationMessage()
      alt confirmationMessage()==false
        WM -> UI : showMessage("Cancelled")
      else proceedStrict
        WM -> WM : checkDuplicateStart()
        alt duplicateFound
          WM -> UI : confirmationMessage()
          alt confirmationMessage()==false
            WM -> UI : showMessage("Cancelled")
          else proceedAfterDuplicate
          end
        end
      end
    end
  else flexibleFormat
    WM -> WM : formatInputForWorkout(command)
    WM -> UI : confirmationMessage()
    alt confirmationMessage()==false
      WM -> UI : showMessage("Cancelled")
    else proceedFlexible
      WM -> WM : checkPastFutureDate()
      WM -> WM : checkDuplicateStart()
    end
  end

WM -> FH : loadMonthList(targetMonth)
WM -> WM : setWorkouts(list,targetMonth)
WM -> W : new(name,startDateTime)
WM -> Tagger : suggest(workout)
WM -> W : setAutoTags(suggestedTags)
WM -> FH : saveMonthList(currentMonth,workouts)
WM -> UI : showMessage("Workout created")

' Deletion: lifeline ends exactly here (no calls to W afterwards)
destroy W

UI -> User : displayMessage()
@enduml
