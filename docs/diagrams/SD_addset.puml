@startuml
title FitChasers Add Set to Exercise - Sequence Diagram
' --- Styling (kept minimal & consistent) ---
skinparam sequenceParticipantType rectangle
skinparam shadowing false
skinparam responseMessageBelowArrow true
hide footbox

actor    User
participant ":UI" as UI
participant ":FitChasers" as App
participant ":WorkoutManager" as WM
participant ":Exercise (current)" as E

User -> UI : enterText()
UI -> App : readCommand()
App -> WM : addSet(command)

alt noActiveWorkout
  WM -> UI : showMessage("No active workout. Use /create_workout first.")
else activeWorkoutExists
  alt noCurrentExercise
    WM -> UI : showMessage("No exercises yet. Add an exercise first with /add_exercise n/NAME r/REPS")
  else hasCurrentExercise
    alt argsMissing
      WM -> UI : showMessage("Missing information. Use: /add_set r/REPS")
      WM -> UI : showMessage("REPS: 1â€“1000")
    else argsPresent
      alt invalidTokenCount
        WM -> UI : showMessage("Provide exactly one r/. Usage: /add_set r/REPS")
      else strayFlagsDetected
        WM -> UI : showMessage("Only r/ is allowed for this command. Usage: /add_set r/REPS")
      else hasRToken
        WM -> WM : extractReps(command)
        alt spaceAfterR
          WM -> UI : showMessage("Invalid reps. Use a whole number between 1 and 1000. Example: /add_set r/15")
        else parseFailedOrOutOfRange
          WM -> UI : showMessage("Invalid reps. Use a whole number between 1 and 1000. Example: /add_set r/15")
        else trailingJunkAfterReps
          WM -> UI : showMessage("Unexpected text after reps. Use exactly: /add_set r/REPS")
        else validReps
          WM -> E : addSet(reps)
          WM -> UI : showMessage("Adding a new set to your exercise!")
          WM -> UI : showMessage("Added set to exercise:\n" + toDetailedString())
        end
      end
    end
  end
end

UI -> User : displayMessage()
@enduml
